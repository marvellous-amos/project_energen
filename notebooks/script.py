# -*- coding: utf-8 -*-
"""energen-time-series.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1tgread4rpXntyAhlP1F9ETGvVUxZ97Jm
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import datetime as dt
import math
import pmdarima
import json

from pandas.plotting import autocorrelation_plot
from statsmodels.tsa.statespace.sarimax import SARIMAX
from sklearn.preprocessing import MinMaxScaler
from IPython.display import Image
from pmdarima import auto_arima

# Serialization (saving the model)
import joblib
from joblib import dump, load

# Commented out IPython magic to ensure Python compatibility.
# %matplotlib inline
pd.options.display.float_format = '{:,.2f}'.format
np.set_printoptions(precision=2)

path = 'drive/MyDrive/_Machine_Learning/project_energen/'

energy_df = pd.read_csv(path + 'data/energy.csv')

energy_df.head(10)

energy_df.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
plt.xlabel('TImestamp', fontsize=12)
plt.ylabel('Load', fontsize=12)
plt.show()

energy_df['timestamp'] = pd.to_datetime(energy_df['timestamp'])
energy_df = energy_df.set_index('timestamp')
# energy_df['2014-07-01':'2014-07-07'].plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
# plt.xlabel('Timestamp', fontsize=12)
# plt.ylabel('Load', fontsize=12)
# plt.show()

energy_df.info()
type(energy_df.index)

"""## Create training and testing datasets"""

#two-month period from september 1 to October 31
train_start_dt = '2014-11-01 00:00:00'
test_start_dt = '2014-12-30 00:00:00'

# energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
#     .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
#     .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
# plt.xlabel('timestamp', fontsize=12)
# plt.ylabel('load', fontsize=12)
# plt.show()

result = energy_df.loc[train_start_dt:, ["load"]].copy()

result["train"] = result["load"].where(result.index < test_start_dt)
result["test"]  = result["load"].where(result.index >= test_start_dt)

result = result.drop(columns="load")

result

result.plot(y=['train', 'test'], figsize=(15, 8), fontsize=18)
plt.xlabel('timestamp', fontsize=12)
plt.ylabel('load', fontsize=12)
plt.show()

"""## Prepare the data for training

We will perform filtering and scaling of the data by:
- Filtering the dataset to only include the time perirods and columns you need, and
- Scaling to ensure the data is projected in the interval 0,1.

train-test split
"""

# train = energy_df.copy()[
#     (energy_df.index >= train_start_dt) &
#      (energy_df.index < test_start_dt)][['load']]

# test = energy_df.copy()[energy_df.index >= test_start_dt][['load']]

# print('Training data shape: ', train.shape)
# print('Test data shape: ', test.shape)

train = energy_df.loc[
    (energy_df.index >= train_start_dt) &
    (energy_df.index < test_start_dt),
    "load"
]

test = energy_df.loc[
    energy_df.index >= test_start_dt,
    "load"
]

# train.describe()
# check if train is dataframe
type(train)

"""scaling"""

# # Scale data: 0,1
# scaler = MinMaxScaler()
# train['load'] = scaler.fit_transform(train)
# train.head(10)

scaler = MinMaxScaler()

train_scaled = scaler.fit_transform(
    train.values.reshape(-1, 1)
).flatten()

test_scaled = scaler.transform(
    test.values.reshape(-1, 1)
).flatten()

train_scaled

# # scale the test data
# test['load'] = scaler.transform(test)
# test.head(10)

energy_df[
    (energy_df.index >= train_start_dt) &
     (energy_df.index < test_start_dt)][['load']] \
.rename(columns={'load':'original load'}) \
.plot.hist(bins=100, fontsize=12)

# train.rename('scaled load').plot.hist(bins=100, fontsize=12)
plt.show()

#save state of data scaler in .joblib file
dump(scaler, f'{path}models/energen_scaler.joblib')

"""## Implementing ARIMA

Since our data is a seasonal one, we will use a seasonal ARIMA model (SARIMA) and parameters: P, D and Q.
"""

HORIZON = 3
print("Forecasting horizon:", HORIZON, "hours")

"""Implementing ARIMA with "auto_arima" from "pmdarima", taking note of seasonality in dataset"""

model = auto_arima(
    train_scaled,
    seasonal=True,
    m=24,
    stepwise=True,
    trace=True,
    suppress_warnings=True,
    error_action="ignore",
)

model.summary()

"""### Save the trained auto_arima model for further processing and production use"""

dump(model, f'{path}models/energen_sarima_auto_model.joblib')

config = {
    "order": model.order,
    "seasonal_order": model.seasonal_order,
    "m": 24,
    "scaler": "MinMaxScaler",
    "train_Start": str(train.index.min()),
    "train_end": str(train.index.max()),
}

with open(f"{path}models/energen_sarima_auto_config.json", "w") as f:
    json.dump(config, f, indent=4)

"""## Forecast using model"""

forecast_scaled = model.predict(n_periods=HORIZON)
forecast = scaler.inverse_transform(forecast_scaled.reshape(-1, 1)).ravel()

print("Forecast (Original scale):", forecast)

"""## Evaluate the Model

load model
"""

model = load(f'{path}models/energen_sarima_auto_model.joblib')
model_config = json.load(open(f"{path}models/energen_sarima_auto_config.json"))

test_shifted = test.to_frame(name='load') # Convert Series to DataFrame with 'load' as column name

for t in range(1, HORIZON+1):
    test_shifted[f'load{t}'] = test_shifted['load'].shift(-t, freq='h') # Create columns like 'load1', 'load2', etc.

test_shifted = test_shifted.dropna(how='any')

# Compare forecast to first horizon of test
eval_df = pd.DataFrame({
    'timestamp': test_shifted.index[:HORIZON],
    'forecast': forecast,
    'actual': test_shifted[['load']].iloc[:HORIZON].values.ravel()
})
eval_df

test_shifted.head()

# Commented out IPython magic to ensure Python compatibility.
# %%time
# training_window = 720 # dedicate 30 days (720 hours) for training
# 
# train_ts = train['load']
# test_ts = test_shifted
# 
# history = [x for x in train_ts]
# history = history[(-training_window):]
# 
# predictions = list()
# 
# order = model_config["order"]
# seasonal_order = model_config["seasonal_order"]
# 
# for t in range(test_ts.shape[0]):
#     model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
#     model_fit = model.fit()
#     yhat = model_fit.forecast(steps = HORIZON)
#     predictions.append(yhat)
#     obs = list(test_ts.iloc[t])
#     # move the training window
#     history.append(obs[0])
#     history.pop(0)
#     print(test_ts.index[t])
#     print(t+1, ': predicted =', yhat, 'expected =', obs)

eval_df = pd.DataFrame(
    predictions,
    columns=[f"t+{t}" for t in range(1, HORIZON + 1)]
)

eval_df["timestamp"] = test_shifted.index

eval_df = pd.melt(
    eval_df,
    id_vars="timestamp",
    value_name="prediction",
    var_name="h"
)

actual_cols = [f"load{t}" for t in range(1, HORIZON + 1)]
eval_df["actual"] = test_shifted[actual_cols].values.ravel()

eval_df[["prediction", "actual"]] = scaler.inverse_transform(
    eval_df[["prediction", "actual"]].values
)

eval_df.head()

"""## check Model Accuracy

Using MAPE.

![image.png](data:image/png;base64,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)

MAPE is used to show prediction accuracy as a ratio defined by the above formula. The difference between actualt and predictedt is divided by the actualt. "The absolute value in this calculation is summed for every forecasted point in time and divided by the number of fitted points n.
"""

# from sklearn.metrics import mean_absolute_error, mean_squared_error
# import numpy as np

# mae = mean_absolute_error(test.values, forecast)
# rmse = np.sqrt(mean_squared_error(test.values, forecast))

# print(f"MAE: {mae:.2f}")
# print(f"RMSE: {rmse:.2f}")

def mape(y_true, y_pred, eps=1e-8):
    y_true, y_pred = np.array(y_true), np.array(y_pred)
    return np.mean(np.abs((y_true - y_pred) / (y_true + eps))) * 100

if(HORIZON > 1):
    eval_df['APE'] = (
        (eval_df['prediction'] - eval_df['actual']).abs()
        / eval_df['actual']
    )
    print(eval_df.groupby('h')['APE'].mean())

print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')

one_step = eval_df[eval_df["h"] == "t+1"]

print(
    "One step forecast MAPE:",
    mape(one_step["actual"], one_step["prediction"]),
    "%"
)

print(
    "Multiple step forecast MAPE:",
    mape(eval_df["actual"], eval_df["prediction"]),
     "%"
)

eval_df['APE'].describe()

eval_df.head()

from sklearn.metrics import mean_absolute_error

eval_df.groupby('h').apply(
    lambda x: mean_absolute_error(x['actual'], x['prediction'])
)

if(HORIZON == 1):
    ## Plotting single step forecast
    eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

else:
    ## Plotting multi step forecast
    plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
    for t in range(1, HORIZON+1):
        plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

    fig = plt.figure(figsize=(15, 8))
    ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
    ax = fig.add_subplot(111)
    for t in range(1, HORIZON+1):
        x = plot_df['timestamp'][(t-1):]
        y = plot_df['t+'+str(t)][0:len(x)]
        ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

    ax.legend(loc='best')

plt.xlabel('timestamp', fontsize=12)
plt.ylabel('load', fontsize=12)
plt.show()